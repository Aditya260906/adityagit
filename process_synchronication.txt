#include <iostream>
 #include <pthread.h>
 #include <semaphore.h>
 #include <unistd.h>
 using namespace std;
 sem_t mutexSemaphore, fullSemaphore, emptySemaphore;
 int buffer[5];
 int inIndex = 0, outIndex = 0;
 void* producer(void*) {
    for (int i = 1; i <= 10; i++) {
        sem_wait(&emptySemaphore);
        sem_wait(&mutexSemaphore);
        buffer[inIndex] = i;
        cout << "Produced: " << i << endl;
        inIndex = (inIndex + 1) % 5;
        sem_post(&mutexSemaphore);
        sem_post(&fullSemaphore);
        sleep(1);
    }
    return NULL;
}
 void* consumer(void*) {
    for (int i = 1; i <= 10; i++) {
        sem_wait(&fullSemaphore);
        sem_wait(&mutexSemaphore);
        int item = buffer[outIndex];
        cout << "Consumed: " << item << endl;
        outIndex = (outIndex + 1) % 5;
        sem_post(&mutexSemaphore);
        sem_post(&emptySemaphore);
        sleep(1);
    }
    return NULL;
 }
 int main() {
    pthread_t producerThread, consumerThread;
    sem_init(&mutexSemaphore, 0, 1);
    sem_init(&fullSemaphore, 0, 0);
    sem_init(&emptySemaphore, 0, 5);
    pthread_create(&producerThread, NULL, producer, NULL);
    pthread_create(&consumerThread, NULL, consumer, NULL);
    pthread_join(producerThread, NULL);
    pthread_join(consumerThread, NULL);
    return 0;
 }