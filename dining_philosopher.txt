 #include <iostream>
 #include <pthread.h>
 #include <semaphore.h>
 #include <unistd.h>
 using namespace std;
 #define PHILOSOPHER_COUNT 5
 sem_t forks[PHILOSOPHER_COUNT];
 void* philosopher(void* num) {
    int id = *(int*)num;
    while (true) {
        // thinking
        sleep(1);
        // pick forks (left then right)
        sem_wait(&forks[id]);
        sem_wait(&forks[(id+1)%PHILOSOPHER_COUNT]);
        cout << "Philosopher " << id << " is eating" << endl;
        sleep(1);
        sem_post(&forks[id]);
        sem_post(&forks[(id+1)%PHILOSOPHER_COUNT]);
        // done eating
        sleep(1);
        break; // single iteration for demo
}
    }
    return NULL;
 int main() {
    pthread_t philosophers[PHILOSOPHER_COUNT];
    int ids[PHILOSOPHER_COUNT];
    for (int i = 0; i < PHILOSOPHER_COUNT; i++) sem_init(&forks[i], 0, 1);
    for (int i = 0; i < PHILOSOPHER_COUNT; i++) { ids[i] = i; pthread_create(&philosophers[i],
 NULL, philosopher, (void*)&ids[i]); }
    for (int i = 0; i < PHILOSOPHER_COUNT; i++) pthread_join(philosophers[i], NULL);
    return 0;
 }