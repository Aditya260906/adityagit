 #include <iostream>
 #include <pthread.h>
 #include <semaphore.h>
 #include <unistd.h>
 using namespace std;
 sem_t mutexSemaphore, writeSemaphore;
 int readCount = 0;
 void* reader(void*) {
    sem_wait(&mutexSemaphore);
    readCount++;
    if (readCount == 1) sem_wait(&writeSemaphore);
    sem_post(&mutexSemaphore);
    cout << "Reader is reading" << endl;
    sleep(1);
    sem_wait(&mutexSemaphore);
    readCount--;
    if (readCount == 0) sem_post(&writeSemaphore);
    sem_post(&mutexSemaphore);
    return NULL;
 }
 void* writer(void*) {
    sem_wait(&writeSemaphore);
    cout << "Writer is writing" << endl;
    sleep(1);
    sem_post(&writeSemaphore);
    return NULL;
 }
 int main() {
    pthread_t r, w;
    sem_init(&mutexSemaphore, 0, 1);
    sem_init(&writeSemaphore, 0, 1);
    pthread_create(&r, NULL, reader, NULL);
    pthread_create(&w, NULL, writer, NULL);
    pthread_join(r, NULL);
}
    pthread_join(w, NULL);
    return 0;